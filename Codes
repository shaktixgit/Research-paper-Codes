# -*- coding: utf-8 -*-
"""
Colab script for visualizing Network Traffic Prediction using Linear Regression.

This script simulates the cyclical network traffic data described in the research paper,
trains a simple linear regression model, and plots the actual vs. predicted values
to illustrate the model's limitations with non-linear, time-series data.
"""

import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

# --- Configuration ---
HOURS_IN_DAY = 24
DAYS_SIMULATED = 7
TOTAL_POINTS = HOURS_IN_DAY * DAYS_SIMULATED
TRAFFIC_BASE = 50
TRAFFIC_AMPLITUDE = 40
NOISE_LEVEL = 8

# 1. Data Simulation (Synthetic Traffic Data)
# Time steps (x-axis)
X = np.arange(TOTAL_POINTS).reshape(-1, 1)

# Generate the underlying sinusoidal pattern (daily cycle)
# Formula: Base + Amplitude * sin(2 * pi * t / Period)
# We use X to represent 't' (time)
sinusoidal_traffic = (
    TRAFFIC_BASE +
    TRAFFIC_AMPLITUDE * np.sin(2 * np.pi * X / HOURS_IN_DAY)
)

# Add random noise to simulate real-world variability (the 'y' variable)
np.random.seed(42) # for reproducibility
noise = np.random.normal(0, NOISE_LEVEL, TOTAL_POINTS).reshape(-1, 1)
Y = sinusoidal_traffic + noise

# 2. Model Training: Simple Linear Regression
# We fit the model on the time step (X) to predict traffic (Y)
model = LinearRegression()
model.fit(X, Y)

# 3. Prediction and Evaluation
Y_pred = model.predict(X)

# Calculate metrics (matching the paper's conceptual results)
mse = mean_squared_error(Y, Y_pred)
r2 = r2_score(Y, Y_pred)

# 4. Visualization
plt.figure(figsize=(12, 7))

# Plot 1: Raw Simulated Traffic Data (Actual observations)
plt.scatter(X, Y, label='Simulated Traffic Data (Raw)', color='#0077c2', alpha=0.6, s=20)

# Plot 2: The Underlying Sinusoidal Trend
plt.plot(X, sinusoidal_traffic, label='Actual Cyclical Trend (Non-Linear)', color='#003d73', linewidth=2.5)

# Plot 3: The Linear Regression Prediction
plt.plot(X, Y_pred, label=f'Linear Regression Prediction (R²: {r2:.2f}, MSE: {mse:.2f})', color='#ff4d4d', linestyle='--', linewidth=3)

# Add labels and title
plt.title('AI-Driven Network Traffic Prediction: Simple Linear Model Performance', fontsize=16, fontweight='bold')
plt.xlabel(f'Time Step (Hours over {DAYS_SIMULATED} Days)', fontsize=12)
plt.ylabel('Normalized Traffic Volume (Units)', fontsize=12)
plt.grid(True, linestyle=':', alpha=0.6)
plt.legend(fontsize=10)
plt.tight_layout()
plt.show()

# Print metrics to the console for reference
print("\n--- Model Metrics (as discussed in the paper) ---")
print(f"Mean Squared Error (MSE): {mse:.2f}")
print(f"R² Score (Coefficient of Determination): {r2:.2f}")
print("\nInterpretation: The negative R² score confirms that the linear model is inadequate for this cyclical data.")
